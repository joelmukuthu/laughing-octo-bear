<h1>Listing missions</h1>

<div class="missions">

  <% if @missions.any? %>

  <p><%= link_to 'New Mission', new_mission_path if can_create_missions? %></p>

  <ul id="missions">
    <% @missions.each_with_index do |mission| %>
    <li>
      <div>
        <h3><%= can_view_missions? ? link_to(mission.title, mission) : mission.title %></h3>

        <p class="meta">
          <span class="owner"><%= t 'missions.by' %> <%= mission.owner.name %></span>
          <% if mission.location? %>
          <span class="location"><%= mission.location %></span>
          <% end %>
          <span class="time"><%= time_ago_in_words mission.created_at %> <%= t 'missions.ago' %></span>
          <span class="views"><%= pluralize mission.views, t('missions.views') %> </span>
          <span class="category"><%= mission.category.name %></span>
        </p>

        <% if mission.image? %>
        <div class="img">
          <% image = image_tag mission.image.url, alt: mission.title %>
          <%= can_view_missions? ? link_to(image, mission) : image %>
        </div>
        <% end %>

        <p class="actions">
          <button class="torches">
            <span></span> 0
          </button>
          <button class="sponsors">
            <span></span> 0
          </button>
          <button class="shares">
            <span></span> 0
          </button>
        </p>

        <% if mission.description? %>
        <p class="reason"><%= mission.description %></p>
        <% end %>

        <% if can_update_mission? mission %>
        <p>
          <%= link_to 'Edit', edit_mission_path(mission) %> |
          <%= link_to 'Destroy', mission, method: :delete, data: { confirm: 'Are you sure?' } %>
        </p>
        <% end %>
      </div>
    </li>
    <% end %>
  </ul>

  <% else %>

  <p>There are no missions yet. <%= link_to 'New Mission', new_mission_path if can_update_missions? %></p>

  <% end %>

</div>